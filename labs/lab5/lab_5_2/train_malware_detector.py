import os

from lab_common.common import ROOT_PROJECT_FOLDER_PATH
from lab_common.labs.lab5.basemalwaredetector import BaseMalwareDetector
from labs.lab5.binmedianproximityembedding import MedianProximityEmbeddingBuilder


LAB6_CACHE_FOLDER = os.path.join(ROOT_PROJECT_FOLDER_PATH, "labs", "lab5", "cache")


def main():
    malware_detector = BaseMalwareDetector(binary_embedding_builder=MedianProximityEmbeddingBuilder,
                                           dataset_size=300,
                                           cache_folder=LAB6_CACHE_FOLDER)

    malware_detector.initialize()

    malware_detector.train_detector_keras(num_layers=10,
                                          epochs=100,
                                          batch_size=64,
                                          hidden_layer_size=512)


if __name__ == "__main__":
    main()